#!/bin/bash
echo ""
echo "# Entreprise: OpenClassrooms"
echo "# Formation: Développeur web"
echo "# Projet: P6 - Construisez une API sécurisée pour une application d'avis gastronomiques"
echo "# Vulnérabilité testé: Broken Access Control (méthodes DELETE et PUT)"
echo "# Source: https://owasp.org/Top10/A01_2021-Broken_Access_Control"
echo ""
echo "Veuillez entrer un Token: " && read bearerToken
echo ""
echo ""
echo "-> OK"
echo ""
echo ""
echo "Veuillez écrire l'ID d'une sauce: " && read idSauce && bearerTokenFiltered=$(echo $bearerToken | sed 's/Authorization\: Bearer //g')
echo ""
echo ""
echo "-> OK"
echo ""
echo ""
echo "Suppression d'une sauce (méthode DELETE):"
echo "curl 'http://localhost:3000/api/sauces/$idSauce' -X DELETE -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0' -H 'Accept: application/json, text/plain, */*' -H 'Accept-Language: fr,fr-FR;q=0.8,en-US;q=0.5,en;q=0.3' --compressed -H 'Authorization: Bearer $bearerTokenFiltered' -H 'Origin: http://localhost:4200' -H 'Connection: keep-alive' -H 'Referer: http://localhost:4200/' -H 'Sec-Fetch-Dest: empty' -H 'Sec-Fetch-Mode: cors' -H 'Sec-Fetch-Site: cross-site'"
echo ""
echo "Modification d'une sauce (méthode PUT):"
echo "curl 'http://localhost:3000/api/sauces/$idSauce' -X PUT -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0' -H 'Accept: application/json, text/plain, */*' -H 'Accept-Language: fr,fr-FR;q=0.8,en-US;q=0.5,en;q=0.3' --compressed -H 'Authorization: Bearer $bearerTokenFiltered' -H 'Content-Type: application/json' -H 'Origin: http://localhost:4200' -H 'Connection: keep-alive' -H 'Referer: http://localhost:4200/' -H 'Sec-Fetch-Dest: empty' -H 'Sec-Fetch-Mode: cors' -H 'Sec-Fetch-Site: cross-site' --data-raw $'{\"name\":\"Modifié via cURL\",\"manufacturer\":\"Modifié via cURL\",\"description\":\"Modifié via cURL\",\"mainPepper\":\"Modifié via cURL\",\"heat\":1}'"
echo ""